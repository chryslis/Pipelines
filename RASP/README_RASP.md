<head>Repetetive Element Alignment and Significance Pipelin</head>

What is required:

Bedtools v2.26.0 or higher
samtools v1.3.1 or higher
bwa v0.7.12 or higher
Perl v5.22.1 or higher
R v3.2.3 or higher

What you need to specify:

Mark: The (epigenomic) mark you are aligning and testing for. Please give a reasonable name since the architechture of the pipeline relies on proper naming of your input.
Paths: You will need the paths to the concatenated genome or a genome in general and to the reads you wish to align.
Sorting Type: If you are using standard repeatmasker track formating, you can sort either by species or by superfamily of your repetetive element. Please note that the pipeline is built for default tab
delimitted repeat masker tracks aquired either through the UCSC Genome browser or from Repbase (sometimes more up-to-date).

What you can change:
In the script "PostConcat", a threshold is adjustable for filtering features with very high clipping e.g a read only overlapps with one basepair and is still counted as read and a total readcount over a feature. Those two conditions are currently hardcoded as at least one read with 60% overlapp meaning the amount of bases of a feature with non-zero coverage has to be at least 60%.
Adjust this as you please.


What this will do:
After everything speciefied, the pipeline will run unsupervised (hopefully).
In the end, you will have an enrichment calculation for your choosen mark.

For singnificance calculation you have four independet scripts which have to be executed manually:

1.Shuffle 

The Shuffle.sh script is built so it will work on a loop giving you the choice how many shuffle each start of the script should perform.
All input files are generated by the RASP main piple and should be on average 15 GB (two files).

2.SignifSub.pl

The Significance Subscript will calculate if an enrichment found by the main pipeline is statistically significant. It will also perform FDR with the Benjaminin Hochberg Correction for the p-values.

3.ResultConstructor.pl

After you have gathered all your marks of interest, execute this script.
It will built a file with the all your features on the coloums and a binary vector for each mark on the rows.
e.g 

		Alu
H3K27ac	0
H3K4me	1

4.(Optional) Kohonen Map Script

This script if you so choose, will execute a script that uses the output of the enrichment to construct a self-organizing map of your data.